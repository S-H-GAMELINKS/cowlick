window.gLocalAssetContainer["node_modules/@xnv/akashic-scrollable/lib/Scrollable.js"] = function(g) { !function(t,e,i,n,r){"use strict";var o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=e("./createDefaultScrollbarImage"),a=e("./NullScrollbar"),h=e("./NinePatchVerticalScrollbar"),l=e("./NinePatchHorizontalScrollbar"),c=function(){function t(t){this._buf=new Array(t),this._i=0,this._disposed=null}return t.prototype.addDelta=function(t){this._buf[this._i]=t,this._i=(this._i+1)%this._buf.length,this._i===this._disposed&&(this._disposed=null)},t.prototype.average=function(){for(var t=0,e=0,i=0,n=null!=this._disposed?this._disposed:(this._i+1)%this._buf.length;n!==this._i;n=(n+1)%this._buf.length)t+=this._buf[n].x,e+=this._buf[n].y,++i;return i>0?{x:t/i,y:e/i}:{x:0,y:0}},t.prototype.reset=function(){this._disposed=this._i},t}(),d=function(t){function e(e){var i=t.call(this,e)||this;return i.onModified=new g.Trigger,i}return o(e,t),e.prototype.destroy=function(){this.onModified.destroy(),this.onModified=null,t.prototype.destroy.call(this)},e.prototype.modified=function(e){return this.onModified&&this.onModified.fire(),t.prototype.modified.call(this,e)},e}(g.E);t.ScrolledContent=d;var u=function(t){function e(e){var i=t.call(this,e)||this;return i.onContentModified=new g.Trigger,i._offsetContainer=new g.E({scene:e.scene,parent:i}),i._content=new d({scene:e.scene,parent:i._offsetContainer}),i._content.onModified.add(i.onContentModified.fire,i.onContentModified),i}return o(e,t),e.prototype.destroy=function(){this.onContentModified.destroy(),this.onContentModified=null,t.prototype.destroy.call(this)},e.prototype.offsetContainer=function(){return this._offsetContainer},e.prototype.content=function(){return this._content},e}(g.E);t.ScrolledContentContainer=u;var _;!function(t){function e(t){return t}function i(t){return t*t}function n(t){return-t*(t-2)}function r(t){return.5>t?t*t*2:-((2*t-1)*(2*t-3)-1)/2}function o(t){return t*t*t}function s(t){return(t-1)*(t-1)*(t-1)+1}function a(t){return.5>t?t*t*t*4:((2*t-2)*(2*t-2)*(2*t-2)+2)/2}function h(t){return-Math.cos(t*(Math.PI/2))+1}function l(t){return Math.sin(t*(Math.PI/2))}function c(t){return-(Math.cos(Math.PI*t)-1)/2}t.Linear=e,t.EaseInQuad=i,t.EaseOutQuad=n,t.EaseInOutQuad=r,t.EaseInQubic=o,t.EaseOutQubic=s,t.EaseInOutQubic=a,t.EaseInSine=h,t.EaseOutSine=l,t.EaseInOutSine=c}(_=t.EasingFunction||(t.EasingFunction={}));var f=function(t){function e(e){var i=t.call(this,e)||this;return i._bgImage=null,i._barImage=null,i._isVertical=!!e.vertical,i._isHorizontal=!!e.horizontal,i._touchScroll=!!e.touchScroll,i._momentumScroll=null!=e.momentumScroll?e.momentumScroll:!0,i._insetBars=!!e.insetBars,i._extraDrawSize=100,i._extraDrawOffsetX=i._extraDrawSize,i._extraDrawOffsetY=i._extraDrawSize,i._contentContainer=new u({scene:e.scene,parent:i}),i._horizontalBar=new a.NullScrollbar({scene:e.scene,parent:i}),i._verticalBar=null,(e.vertical===!0||e.horizontal===!0)&&(i._bgImage=s.createDefaultScrollbarImage(e.scene.game,7,"rgba(255, 255, 255, 0.2)",4,"rgba(218, 218, 218, 0.5)"),i._barImage=s.createDefaultScrollbarImage(e.scene.game,7,"rgba(255, 255, 255, 0.5)",4,"rgba(164, 164, 164, 0.7)")),i._verticalBar=e.vertical===!0?new h.NinePatchVerticalScrollbar({scene:e.scene,bgImage:i._bgImage,image:i._barImage}):e.vertical?e.vertical:new a.NullScrollbar({scene:e.scene}),i._verticalBar.x=i._insetBars?i.width-i._verticalBar.width:i.width,i.append(i._verticalBar),i._verticalBar.onChangeBarPositionRate.add(i._handleOnChangeVerticalPositionRate,i),i._horizontalBar=e.horizontal===!0?new l.NinePatchHorizontalScrollbar({scene:e.scene,bgImage:i._bgImage,image:i._barImage}):e.horizontal?e.horizontal:new a.NullScrollbar({scene:e.scene}),i._horizontalBar.y=i._insetBars?i.height-i._horizontalBar.height:i.height,i.append(i._horizontalBar),i._horizontalBar.onChangeBarPositionRate.add(i._handleOnChangeHorizontalPositionRate,i),i._surface=null,i._renderer=null,i._isCached=!1,i._renderedCamera=null,i._renderOffsetX=0,i._renderOffsetY=0,i._contentBoundingWidth=0,i._contentBoundingHeight=0,i._isUpdateBoundingRectRequested=!1,i._isUpdateContentScrollRequested=!1,i._isUpdateScrollbarRequested=!1,i._isFlushRequested=!1,i._lastNotifiedVerticalRate=null,i._lastNotifiedHorizontalRate=null,i._deltaX=0,i._deltaY=0,i._apiRequestedOffsetX=null,i._apiRequestedOffsetY=null,i._beforeWidth=e.width,i._beforeHeight=e.height,i._frameTasks=[],i._momentumBuffer=new c(3),i._contentContainer.onContentModified.add(i._handleContentModified,i),i._touchScroll&&(i.touchable=!0,i.pointDown.add(i._handlePointDown,i),i.pointMove.add(i._handlePointMove,i),i.pointUp.add(i._handlePointUp,i)),i._requestUpdateBoundingRect(),i._requestUpdateScrollbar(),i}return o(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this._contentContainer.content()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollOffsetX",{get:function(){return-this._contentContainer.offsetContainer().x},set:function(t){this._apiRequestedOffsetX=-t,this._requestUpdateContentScroll(),this._requestUpdateScrollbar()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollOffsetY",{get:function(){return-this._contentContainer.offsetContainer().y},set:function(t){this._apiRequestedOffsetY=-t,this._requestUpdateContentScroll(),this._requestUpdateScrollbar()},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._contentContainer=null,this._horizontalBar=null,this._verticalBar=null,this._surface&&(this._surface.destroy(),this._surface=null),this._renderer=null,this._isCached=!1,this._renderedCamera=null,this._renderOffsetX=0,this._renderOffsetY=0,this._bgImage&&(this._bgImage.destroy(),this._bgImage=null),this._barImage&&(this._barImage.destroy(),this._barImage=null),t.prototype.destroy.call(this)},e.prototype.getScrollOffsetPercentX=function(){this._flushModification();var t=this._contentBoundingWidth-this.width;return t>0?100*this.scrollOffsetX/t:0},e.prototype.setScrollOffsetPercentX=function(t){this._flushModification();var e=Math.max(this._contentBoundingWidth-this.width,0);this.scrollOffsetX=Math.floor(t*e/100)},e.prototype.getScrollOffsetPercentY=function(){this._flushModification();var t=this._contentBoundingHeight-this.height;return t>0?100*this.scrollOffsetY/t:0},e.prototype.setScrollOffsetPercentY=function(t){this._flushModification();var e=Math.max(this._contentBoundingHeight-this.height,0);this.scrollOffsetY=Math.floor(t*e/100)},e.prototype.scrollToX=function(t,e,i){this._addFrameTask({type:"scroll",origX:-this._contentContainer.offsetContainer().x,x:t,duration:e,easing:i,count:0})},e.prototype.scrollToY=function(t,e,i){this._addFrameTask({type:"scroll",origY:-this._contentContainer.offsetContainer().y,y:t,duration:e,easing:i,count:0})},e.prototype.scrollToPercentX=function(t,e,i){this._addFrameTask({type:"scroll",origX:-this._contentContainer.offsetContainer().x,perX:t,duration:e,easing:i,count:0})},e.prototype.scrollToPercentY=function(t,e,i){this._addFrameTask({type:"scroll",origY:-this._contentContainer.offsetContainer().y,perY:t,duration:e,easing:i,count:0})},e.prototype.renderSelf=function(t,e){if(this._renderedCamera!==e&&(this._isCached=!1,this._renderedCamera=e),this._isCached||this._renderCache(e),this.children)for(var i=this.children,n=0;n<i.length;++n)if(i[n]===this._contentContainer){if(this._surface&&this.width>0&&this.height>0){var r=this._extraDrawOffsetX-this._renderOffsetX,o=this._extraDrawOffsetY-this._renderOffsetY;t.drawImage(this._surface,r,o,this.width,this.height,0,0)}}else i[n].render(t,e);return!1},e.prototype.modified=function(e){e&&(this._isCached=!1);var i=!1;this.width!==this._beforeWidth&&(i=!0,this._beforeWidth=this.width,this._verticalBar&&(this._verticalBar.x=this._insetBars?this.width-this._verticalBar.width:this.width,this._verticalBar.modified())),this.height!==this._beforeHeight&&(i=!0,this._beforeHeight=this.height,this._horizontalBar&&(this._horizontalBar.y=this._insetBars?this.height-this._horizontalBar.height:this.height,this._horizontalBar.modified())),i&&(this._requestUpdateContentScroll(),this._requestUpdateScrollbar()),t.prototype.modified.call(this,e)},e.prototype.shouldFindChildrenByPoint=function(t){var e=this.width+(this._insetBars?0:this._verticalBar.width),i=this.height+(this._insetBars?0:this._horizontalBar.height);return 0<=t.x&&t.x<e&&0<=t.y&&t.y<i},e.prototype._addFrameTask=function(t){this._frameTasks.push(t),1===this._frameTasks.length&&this._contentContainer.update.add(this._onUpdate,this)},e.prototype._cancelFrameTask=function(t){for(var e=0;e<this._frameTasks.length;++e){var i=this._frameTasks[e];i.type===t&&(i.done=!0)}},e.prototype._onUpdate=function(){for(var t=0;t<this._frameTasks.length;++t){var e=this._frameTasks[t];switch(e.done&&this._frameTasks.splice(t,1),++e.count,e.type){case"momentum":var i=Math.pow(.9,e.count),n={x:e.x*i,y:e.y*i};e.done=(!this._isHorizontal||Math.abs(n.x)<.1)&&(!this._isVertical||Math.abs(n.y)<.1),this._addScrollDelta(n);break;case"scroll":this._flushModification();var r=Math.min(1e3*e.count/(e.duration*this.scene.game.fps),1),o=e.easing?e.easing(r):r;if(null!=e.x||null!=e.perX){var s=null!=e.x?e.x:e.perX*Math.max(this._contentBoundingWidth-this.width,0)/100,a=e.origX+o*(s-e.origX);this.scrollOffsetX=a}if(null!=e.y||null!=e.perY){var h=null!=e.y?e.y:e.perY*Math.max(this._contentBoundingHeight-this.height,0)/100,l=e.origY+o*(h-e.origY);this.scrollOffsetY=l}e.done=1===r;break;default:throw new Error("Scrollable#_onUpdate: never reach")}}0===this._frameTasks.length&&this._contentContainer.update.remove(this._onUpdate,this)},e.prototype._handleContentModified=function(){this._requestUpdateBoundingRect()},e.prototype._handleOnChangeVerticalPositionRate=function(t){this._lastNotifiedVerticalRate=t,this._requestUpdateContentScroll()},e.prototype._handleOnChangeHorizontalPositionRate=function(t){this._lastNotifiedHorizontalRate=t,this._requestUpdateContentScroll()},e.prototype._handlePointDown=function(t){this._cancelFrameTask("momentum"),this._momentumBuffer.reset()},e.prototype._handlePointMove=function(t){this._addScrollDelta(t.prevDelta),this._momentumBuffer.addDelta(t.prevDelta)},e.prototype._handlePointUp=function(t){if(this._momentumScroll){var e=this._momentumBuffer.average();(this._isHorizontal&&Math.abs(e.x)>2||this._isVertical&&Math.abs(e.y)>2)&&this._addFrameTask({type:"momentum",x:e.x,y:e.y,count:0})}},e.prototype._addScrollDelta=function(t){this._deltaX+=t.x,this._deltaY+=t.y,this._requestUpdateScrollbar(),this._requestUpdateContentScroll(),this.modified()},e.prototype._requestUpdateBoundingRect=function(){this._isUpdateBoundingRectRequested||(this._isUpdateBoundingRectRequested=!0,this._requestFlushModification())},e.prototype._requestUpdateScrollbar=function(){this._isUpdateScrollbarRequested||(this._isUpdateScrollbarRequested=!0,this._requestFlushModification())},e.prototype._requestUpdateContentScroll=function(){this._isUpdateContentScrollRequested||(this._isUpdateContentScrollRequested=!0,this._requestFlushModification())},e.prototype._requestFlushModification=function(){var t=this;this._isFlushRequested||(this._isFlushRequested=!0,this.scene.game._callSceneAssetHolderHandler({callHandler:function(){t.destroyed()||t._flushModification()}}))},e.prototype._flushModification=function(){if(this._isFlushRequested){this._isFlushRequested=!1;var t=!1;this._isUpdateBoundingRectRequested&&(this._isUpdateBoundingRectRequested=!1,t=this._updateBoundingRect()),(t||this._isUpdateContentScrollRequested)&&(this._isUpdateContentScrollRequested=!1,this._updateContentScroll()),(t||this._isUpdateScrollbarRequested)&&(this._isUpdateScrollbarRequested=!1,this._updateScrollBar())}},e.prototype._updateBoundingRect=function(){var t=this._calculateBoundingRectSize(),e=!1;return this._contentBoundingWidth!==t.width&&(this._contentBoundingWidth=t.width,e=!0),this._contentBoundingHeight!==t.height&&(this._contentBoundingHeight=t.height,e=!0),e},e.prototype._calculateBoundingRectSize=function(){var t=this._contentContainer.content(),e=t.calculateBoundingRect(),i=e.right-e.left,n=e.bottom-e.top;return{width:i,height:n}},e.prototype._updateContentScroll=function(){var t=this._contentContainer.offsetContainer(),e=this._lastNotifiedVerticalRate,i=this._lastNotifiedHorizontalRate,n=this._deltaX,r=this._deltaY,o=this._apiRequestedOffsetX,s=this._apiRequestedOffsetY;if(this._lastNotifiedVerticalRate=null,this._lastNotifiedHorizontalRate=null,this._deltaX=0,this._deltaY=0,this._apiRequestedOffsetX=null,this._apiRequestedOffsetY=null,this._isHorizontal){var a=t.x,h=null!=o?o:a,l=0!==n?h+n:null!=i?-i*this._contentBoundingWidth:h,c=Math.max(Math.min(l,0),Math.min(this.width-this._contentBoundingWidth,0));t.x=c,this._renderOffsetX+=t.x-a}if(this._isVertical){var d=t.y,u=null!=s?s:d,_=0!==r?u+r:null!=e?-e*this._contentBoundingHeight:u,f=Math.max(Math.min(_,0),Math.min(this.height-this._contentBoundingHeight,0));t.y=f,this._renderOffsetY+=f-d}(Math.abs(this._renderOffsetX)>this._extraDrawSize||Math.abs(this._renderOffsetY)>this._extraDrawSize)&&(this._isCached=!1)},e.prototype._updateScrollBar=function(){var t=this._contentContainer.offsetContainer();this._horizontalBar.setBarProperties(-t.x/this._contentBoundingWidth,this._contentBoundingWidth,this.width),this._verticalBar.setBarProperties(-t.y/this._contentBoundingHeight,this._contentBoundingHeight,this.height)},e.prototype._renderCache=function(t){var e=Math.ceil(this.width+2*this._extraDrawSize),i=Math.ceil(this.height+2*this._extraDrawSize),n=!this._surface||this._surface.width<e||this._surface.height<i;n&&(this._surface&&!this._surface.destroyed()&&this._surface.destroy(),this._surface=this.scene.game.resourceFactory.createSurface(e,i),this._renderer=this._surface.renderer()),this._renderer.begin(),n||this._renderer.clear(),this._renderer.save(),this._renderer.translate(this._extraDrawOffsetX,this._extraDrawOffsetY),this._contentContainer.render(this._renderer,t),this._renderer.restore(),this._renderOffsetX=0,this._renderOffsetY=0,this._renderer.end(),this._isCached=!0},e}(g.E);f.Easing=_,t.Scrollable=f}(g.module.exports,g.module.require,g.module,g.filename,g.dirname);}