module.exports=function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=29)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.choice="choice",e.image="image",e.pane="pane",e.jump="jump",e.text="text",e.layerConfig="layerConfig",e.playAudio="playAudio",e.changeVolume="changeVolume",e.stopAudio="stopAudio",e.playVideo="playVideo",e.stopVideo="stopVideo",e.click="click",e.button="button",e.trigger="trigger",e.save="save",e.load="load",e.evaluate="eval",e.link="link",e.openSaveWindow="openSaveWindow",e.openLoadWindow="openLoadWindow",e.condition="condition",e.backlog="backlog",e.removeLayer="removeLayer"}(t.Tag||(t.Tag={}));!function(e){e.system="system",e.background="background",e.choice="choice",e.message="message",e.backlog="backlog"}(t.Layer||(t.Layer={})),t.gameId="$gameId";!function(e){e.system="system",e.saveDataPrefix="data"}(t.Region||(t.Region={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collectAssetIds=function(e){let t=[];for(const i of e)"object"==typeof i.data&&(i.data.assetId?t.push(i.data.assetId):i.data.backgroundImage&&t.push(i.data.backgroundImage));return t}},function(e,t,i){"use strict";function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);n(i(11));var r=i(0);t.Tag=r.Tag,t.Layer=r.Layer,n(i(4)),n(i(25)),n(i(26)),n(i(1)),n(i(10)),t.engine=new s.Engine(g.game)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(4),s=i(14),r=i(11),a=i(21),o=i(22),h=i(9);class u{constructor(e){this.game=e;const t=g._require(e,"config");t&&(u._config=t)}set config(e){u._config=e}static get scriptManager(){return u._scriptManager}static get config(){return u._config}start(e){const t=e||n.Scenario.load(this.game),i=h.createStorageKeys(u.player,u._config.system.maxSaveCount),r=new s.Scene({game:this.game,scenario:t,scriptManager:u.scriptManager,config:u.config,player:u.player,storageKeys:i});this.game.pushScene(r)}script(e,t){u.scriptManager.register(e,t)}}u._scriptManager=new a.ScriptManager(o.defaultSctipts),u._config=r.defaultConfig,u.player={id:"0"},t.Engine=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.index=0,this.scenes=e}static load(e){return g._require(e,"scenario")}get scene(){return this.index<this.scenes.length?this.scenes[this.index]:void 0}get frame(){return this.index<this.scenes.length?this.scenes[this.index].frame:void 0}nextFrame(){return this.index<this.scenes.length?this.scenes[this.index].next():void 0}update(e){const t=this.scenes.findIndex(t=>t.label===e.label);return t>-1&&(this.index=t,this.scenes[this.index].reset(e.frame),!0)}}t.Scenario=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(17);class s extends n.Label{constructor(e){super({scene:e.scene,font:new g.DynamicFont({game:e.scene.game,fontFamily:g.FontFamily.SansSerif,size:18}),text:"",fontSize:18,textColor:e.config.font.color,width:e.width,x:e.x,y:e.y}),this.index=0,this.counter=0,this.original={values:[]},this.current=[],this.gameState=e.gameState,this.textAlign=g.TextAlign.Left,this.update.add(this.onUpdated,this)}get finished(){return this.index>=this.original.values.length}updateText(e){e.clear?(this.text="",this.original=e,this.index=0,this.counter=0,this.setCurrent()):this.original={values:this.original.values.concat(e.values)}}showAll(){if(!this.finished){this.update.remove(this.onUpdated,this),this.text="";for(const e of this.original.values)if("string"==typeof e)this.text+=e;else if(Array.isArray(e))this.text+=e[e.length-1].value;else{const t=this.gameState.getStringValue(e);t?this.text+=t:this.scene.game.logger.warn("変数の取得に失敗しました",e)}this.index=this.original.values.length,this.invalidate(),this.update.add(this.onUpdated,this)}}onUpdated(){if(!this.finished&&this.counter>=this.current.length&&(this.counter=0,this.index++,this.finished||this.setCurrent()),!this.finished){const e=this.current[this.counter];"string"==typeof e?this.text+=e:(0!==this.counter&&(this.text=this.text.substring(0,this.text.length-e.value.length)),this.text+=e.value),this.invalidate(),this.counter++}}setCurrent(){const e=this.original.values[this.index];if("string"==typeof e)this.current=e.split(/.*?/);else if(Array.isArray(e))this.current=e;else{const t=this.gameState.getStringValue(e);t?this.current=t.split(/.*?/):this.scene.game.logger.warn("変数の取得に失敗しました",e)}}}t.Message=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Center=0]="Center",e[e.SpaceAround=1]="SpaceAround"}(t.RubyAlign||(t.RubyAlign={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,i){this.text=e,this.width=t,this.glyphs=i}}();t.StringDrawInfo=n;var s=function(){return function(e,t,i,n,s,r){this.text=e.text,this.fragment=e,this.width=t,this.rbWidth=i,this.rtWidth=n,this.glyphs=s,this.rubyGlyphs=r}}();t.RubyFragmentDrawInfo=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e){for(var t=/^((?:[^\\{]|\\+.)*?)({(?:[^\\}]|\\+.)*?})([\s\S]*)/,i=[];e.length>0;){var n=e.match(t);if(null===n){i.push(e.replace(/\\{/g,"{").replace(/\\}/g,"}"));break}var s=n[1],r=n[2];e=n[3],s.length>0&&i.push(s.replace(/\\{/g,"{").replace(/\\}/g,"}"));var a=JSON.parse(r.replace(/\\/g,"\\\\"));if(!a.hasOwnProperty("rt")||!a.hasOwnProperty("rb"))throw g.ExceptionFactory.createTypeMismatchError("parse","RubyFragment");a.rt=a.rt.replace(/\\{/g,"{").replace(/\\}/g,"}"),a.rb=a.rb.replace(/\\{/g,"{").replace(/\\}/g,"}"),a.text=r,i.push(a)}return i}},function(e,t,i){"use strict";function n(e,t,i){const n={system:{},current:{}},s=[];for(const i of t)for(const t of e.storageValues.get(i)){const e="number"==typeof t.data?t.data:JSON.parse(t.data);if(i.regionKey===r.Region.system)n.system=e;else{let n=s.find(e=>e.key===t.storageKey);const r=i.regionKey.split(".");if(!n){const e=parseInt(r[0].substring(a),10);n={key:t.storageKey,value:{label:"",frame:0,variables:{}}},s[e]=n}switch(r[r.length-1]){case"frame":n.value.frame=e;break;case"label":n.value.label=e;break;default:n.value.variables=e}}}return{data:s.map(e=>e.value),variables:n}}Object.defineProperty(t,"__esModule",{value:!0});const s=i(10),r=i(0),a=r.Region.saveDataPrefix.length;t.loadGameState=function(e,t,i){const r=n(e,t,i);return new s.GameState(r.data,r.variables,i)},t.createStorageKeys=function(e,t){const i=[{region:g.StorageRegion.Values,regionKey:r.Region.system,userId:e.id,gameId:r.gameId}];for(let n=0;n<t-1;n++)i.push({region:g.StorageRegion.Values,regionKey:r.Region.saveDataPrefix+n,userId:e.id,gameId:r.gameId});return i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,i){this.data=e,this._variables=t,this.max=i}get variables(){return this._variables}exists(e){return void 0===this.data[e]}save(e,t){if(t.index>this.max||t.index<0)return"storage out of range: "+t.index;const i=e.createSaveData(this._variables.current);return t.force?(this.data[t.index]=i,i):this.exists(t.index)?"save data already exists: "+t.index:(this.data[t.index]=i,i)}load(e){const t=this.data[e];return t&&(this._variables.current=t.variables),t}getStringValue(e){const t=("system"===e.type?this._variables.system:this._variables.current)[e.name];return t?String(t):void 0}}t.GameState=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);t.defaultConfig={window:{message:{layer:{name:n.Layer.message,x:10,y:10},width:g.game.width-20,height:g.game.height-20,touchable:!0},system:[],load:[],save:[]},font:{color:"black"},system:{maxSaveCount:100},audio:{voice:.5,se:.5,bgm:.5}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends g.Pane{constructor(e){super({scene:e.scene,width:e.width,height:e.height,backgroundImage:e.backgroundImage?e.scene.assets[e.backgroundImage]:void 0,padding:e.padding,backgroundEffector:e.backgroundEffector?new g.NinePatchSurfaceEffector(e.scene.game,e.backgroundEffector.borderWidth):void 0}),this.touchable=!0,this.pointDown.add(this.onPointDown,this),this.pointMove.add(this.onPointMove,this),this.pointUp.add(this.onPointUp,this),this.click=new g.Trigger,this.pushed=!1}move(e,t){this.x=e,this.y=t,this.modified()}onPointDown(e){this.pushed||this.push()}push(){this.y+=2,this.height-=2,this.pushed=!0,this.modified()}unpush(){this.y-=2,this.height+=2,this.pushed=!1,this.modified()}isHover(e){let t={x:e.point.x+e.startDelta.x,y:e.point.y+e.startDelta.y};return!(t.x<0||t.y<0)&&!(t.x>=this.width||t.y>=this.height)}onPointMove(e){let t=this.isHover(e);this.pushed&&!t?this.unpush():!this.pushed&&t&&this.push()}onPointUp(e){this.pushed&&(this.click.fire(this),this.unpush())}}t.Button=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=function(e,t){const i=e.assets[t.assetId];let n;if(t.frame){let s=new g.FrameSprite({scene:e,src:i,width:t.frame.width,height:t.frame.height});s.frames=t.frame.frames,s.interval=1e3,s.start(),n=s}else n=new g.Sprite({scene:e,src:i});return void 0!==t.layer.x&&(n.x=t.layer.x),void 0!==t.layer.y&&(n.y=t.layer.y),n.invalidate(),n}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(15),s=i(16),r=i(1),a=i(5),o=i(19),h=i(20),u=i(9),c=i(0);class d extends g.Scene{constructor(e){super({game:e.game,assetIds:d.collectAssetIds(e),storageKeys:e.state?void 0:e.storageKeys}),this._onWindowClick=this.onWindowClick.bind(this),this._requestNextFrame=this.requestNextFrame.bind(this),this._loadFrame=this.loadFrame.bind(this),this.layerGroup=new o.LayerGroup(this),this.scriptManager=e.scriptManager,this.config=e.config,this.audioGroup=new h.AudioGroup(this.game,e.config.audio),this.videos=[],this.player=e.player,this.storageKeys=e.storageKeys,e.state&&(this._gameState=e.state),this.loaded.add(this.onLoaded,this),this.scenario=new n.ScenarioViewModel(e.scenario),this.scenario.loadFrame(this._loadFrame)}get source(){return this.scenario.source}get gameState(){return this._gameState}get backlog(){return this.scenario.backlog}jump(e){const t=this.source.scene.label;this.source.update(e)?t===this.source.scene.label?this.scenario.load()||this.game.logger.warn("scene not found",e):this.game.pushScene(new d({game:this.game,scenario:this.source,scriptManager:this.scriptManager,config:this.config,player:this.player,state:this._gameState})):this.game.logger.warn("scene not found",e)}appendLayer(e,t){this.layerGroup.append(e,t)}removeLayer(e){this.layerGroup.remove(e)}updateText(e){this._message.updateText(e),this.disableTrigger(this._requestNextFrame),this.enableWindowClick()}applyLayerConfig(e){this.layerGroup.applyConfig(e)}addSkipTrigger(){this.pointUpCapture.addOnce(this._requestNextFrame,this)}disableWindowClick(){this._message.finished?this.disableTrigger(this._requestNextFrame):this.disableTrigger(this._onWindowClick)}enableWindowClick(){this.layerGroup.evaluate(c.Layer.message,e=>{if(e.touchable=!0,this._message.finished){e.pointUp.add(this._requestNextFrame,e);for(const t of e.children)t.pointUp.add(this._requestNextFrame,t)}else{e.pointUp.addOnce(this._onWindowClick,e);for(const t of e.children)t.pointUp.addOnce(this._onWindowClick,t)}})}transition(e,t){this.layerGroup.evaluate(e,t)}requestNextFrame(){this.scenario.next()||this.game.logger.warn("next frame not found: "+this.scenario.source.scene.label)}playAudio(e){const t=this.assets[e.assetId].play();this.audioGroup.add(e.groupName,t)}changeVolume(e){this.audioGroup.changeVolume(e.groupName,e.volume)}stopAudio(e){this.audioGroup.remove(e)}playVideo(e){const t=this.assets[e.assetId];t.play(),this.videos.push(t)}stopVideo(e){const t=this.videos.findIndex(t=>t.id===e.assetId);if(t>0){const e=this.videos[t];e.stop(),e.destroy(),this.videos.splice(t,1)}else this.game.logger.warn("video not found: "+e.assetId)}save(e,t){return this.storage.save(e,t)}load(e){return this.storage.load(e)}onLoaded(){const e=this.scenario.source.frame;this._gameState||(this._gameState=u.loadGameState(this,this.storageKeys,this.config.system.maxSaveCount)),this.storage=new s.StorageViewModel(this.game.storage,this.player,this._gameState),e?(this.removeLayers(e.scripts),this.createWindowLayer(),this.createSystemLayer(),this.applyScripts(e.scripts)):(this.createWindowLayer(),this.createSystemLayer()),this.topMessageLayer(),this.layerGroup.top(c.Layer.system)}disableTrigger(e){this.layerGroup.evaluate(c.Layer.message,t=>{t.touchable=!1,t.pointUp.remove(e,t);for(const i of t.children)i.pointUp.remove(e,i)})}loadFrame(e){e&&(this.removeLayers(e.scripts),this.applyScripts(e.scripts)),this.topMessageLayer(),this.layerGroup.top(c.Layer.system)}topMessageLayer(){this.layerGroup.evaluate(c.Layer.message,e=>{e.touchable&&this.layerGroup.top(c.Layer.message)})}createWindowLayer(){this.scriptManager.call(this,{tag:c.Tag.pane,data:this.config.window.message}),this.layerGroup.evaluate(c.Layer.message,e=>{this._message=new a.Message({scene:this,config:this.config,width:this.game.width-40,x:this.config.window.message.layer.x+20,y:this.config.window.message.layer.y+20,gameState:this.gameState}),e.append(this._message)}),this.enableWindowClick()}createSystemLayer(){for(const e of this.config.window.system)this.scriptManager.call(this,e)}removeLayers(e){const t=new Set;e.forEach(e=>{e.data.layer&&t.add(e.data.layer)}),t.forEach(e=>{this.layerGroup.remove(e)})}applyScripts(e){e.forEach(e=>{this.scriptManager.call(this,e)})}static collectAssetIds(e){const t=e.scenario.scene.assetIds.concat(r.collectAssetIds(e.config.window.system));return e.config.window.message.backgroundImage&&t.push(e.config.window.message.backgroundImage),t}onWindowClick(){this._message.finished?this.requestNextFrame():(this._message.showAll(),this.enableWindowClick())}}t.Scene=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.scenario=e,this.frameTrigger=new g.Trigger,this.log=[]}get source(){return this.scenario}get backlog(){return this.log}loadFrame(e){this.frameTrigger.add(e)}load(e){const t=e||this.source.frame;return!!t&&(this.frameTrigger.fire(t),!0)}next(){const e=this.source.frame;return!!this.load(this.source.nextFrame())&&(this.log.push(e),!0)}}t.ScenarioViewModel=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);class s{constructor(e,t,i){this.storage=e,this.player=t,this.state=i}load(e){return this.state.load(e)}save(e,t){const i=this.state.save(e,t);if("string"==typeof i)return i;{const e=n.Region.saveDataPrefix+t.index+".";return this.write(i.variables,e+"variables"),this.write(i.label,e+"label"),void this.write(i.frame,e+"frame")}}saveSystemVariables(){this.write(this.state.variables.system,n.Region.system)}write(e,t){this.storage.write({region:g.StorageRegion.Values,regionKey:t,userId:this.player.id,gameId:n.gameId},{data:JSON.stringify(e)})}}t.StorageViewModel=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Label=i(18),t.FragmentDrawInfo=i(7),t.RubyParser=i(6),t.RubyAlign=t.RubyParser.RubyAlign;var n=i(8);t.defaultRubyParser=n.parse},function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=i(6),r=i(7),a=i(8),o=function(e){function t(t){var i=this;if(!t.font&&!t.bitmapFont)throw g.ExceptionFactory.createAssertionError("Label#constructor: 'font' or 'bitmapFont' must be given to LabelParameterObject");return i=e.call(this,t)||this,i.text=t.text,i.bitmapFont=t.bitmapFont,i.font=t.font?t.font:t.bitmapFont,i.fontSize=t.fontSize,i._lineBreakWidth=t.width,i.lineBreak=!("lineBreak"in t)||t.lineBreak,i.lineGap=t.lineGap||0,i.textAlign="textAlign"in t?t.textAlign:g.TextAlign.Left,i.textColor=t.textColor,i.trimMarginTop="trimMarginTop"in t&&t.trimMarginTop,i.widthAutoAdjust="widthAutoAdjust"in t&&t.widthAutoAdjust,i.rubyEnabled=!("rubyEnabled"in t)||t.rubyEnabled,i.fixLineGap="fixLineGap"in t&&t.fixLineGap,i.rubyParser="rubyParser"in t?t.rubyParser:a.parse,t.rubyOptions||(t.rubyOptions={}),i.rubyOptions=t.rubyOptions,i.rubyOptions.rubyFontSize="rubyFontSize"in t.rubyOptions?t.rubyOptions.rubyFontSize:t.fontSize/2,i.rubyOptions.rubyBitmapFont="rubyBitmapFont"in t.rubyOptions?t.rubyOptions.rubyBitmapFont:i.bitmapFont,i.rubyOptions.rubyFont="rubyFont"in t.rubyOptions?t.rubyOptions.rubyFont:i.font,i.rubyOptions.rubyGap="rubyGap"in t.rubyOptions?t.rubyOptions.rubyGap:0,i.rubyOptions.rubyAlign="rubyAlign"in t.rubyOptions?t.rubyOptions.rubyAlign:s.RubyAlign.SpaceAround,i._lines=[],i._beforeText=void 0,i._beforeTextAlign=void 0,i._beforeFontSize=void 0,i._beforeLineBreak=void 0,i._beforeFont=void 0,i._beforeWidth=void 0,i._beforeRubyEnabled=void 0,i._beforeFixLineGap=void 0,i._beforeTrimMarginTop=void 0,i._beforeWidthAutoAdjust=void 0,i._beforeRubyOptions={},i._invalidateSelf(),i}return n(t,e),t.prototype.invalidate=function(){this._invalidateSelf(),e.prototype.invalidate.call(this)},t.prototype.renderCache=function(e){if(this.rubyEnabled||0!==this.fontSize){e.save();for(var t=0,i=0;i<this._lines.length;++i)this._lines[i].width>0&&this._lines[i].height>0&&e.drawImage(this._lines[i].surface,0,0,this._lines[i].width,this._lines[i].height,this._offsetX(this._lines[i].width),t),t+=this._lines[i].height+this.lineGap;this.textColor&&(e.setCompositeOperation(g.CompositeOperation.SourceAtop),e.fillRect(0,0,this._lineBreakWidth,this.height,this.textColor)),e.restore()}},t.prototype.destroy=function(){this._destroyLines(),e.prototype.destroy.call(this)},t.prototype._offsetX=function(e){switch(this.textAlign){case g.TextAlign.Left:return 0;case g.TextAlign.Right:return this._lineBreakWidth-e;case g.TextAlign.Center:return(this._lineBreakWidth-e)/2;default:return 0}},t.prototype._destroyLines=function(){for(var e=0;e<this._lines.length;e++)this._lines[e].surface&&!this._lines[e].surface.destroyed()&&this._lines[e].surface.destroy();this._lines=void 0},t.prototype._invalidateSelf=function(){if(this.fontSize<0)throw g.ExceptionFactory.createAssertionError("Label#_invalidateSelf: fontSize must not be negative.");if(this.lineGap<-1*this.fontSize)throw g.ExceptionFactory.createAssertionError("Label#_invalidateSelf: lineGap must be greater than -1 * fontSize.");void 0!==this.bitmapFont&&(this.font=this.bitmapFont),void 0!==this.rubyOptions.rubyBitmapFont&&(this.rubyOptions.rubyFont=this.rubyOptions.rubyBitmapFont),this._beforeWidth!==this.width&&(this._lineBreakWidth=this.width),(this._beforeText!==this.text||this._beforeFontSize!==this.fontSize||this._beforeFont!==this.font||this._beforeLineBreak!==this.lineBreak||this._beforeWidth!==this.width&&!0===this._beforeLineBreak||this._beforeTextAlign!==this.textAlign||this._beforeRubyEnabled!==this.rubyEnabled||this._beforeFixLineGap!==this.fixLineGap||this._beforeTrimMarginTop!==this.trimMarginTop||this._beforeWidthAutoAdjust!==this.widthAutoAdjust||this._isDifferentRubyOptions(this._beforeRubyOptions,this.rubyOptions))&&this._updateLines(),this.widthAutoAdjust&&(this.width=Math.ceil(this._lines.reduce(function(e,t){return Math.max(e,t.width)},0)));for(var e=this.lineGap*(this._lines.length-1),t=0;t<this._lines.length;t++)e+=this._lines[t].height;this.height=e,this._beforeText=this.text,this._beforeTextAlign=this.textAlign,this._beforeFontSize=this.fontSize,this._beforeLineBreak=this.lineBreak,this._beforeFont=this.font,this._beforeWidth=this.width,this._beforeRubyEnabled=this.rubyEnabled,this._beforeFixLineGap=this.fixLineGap,this._beforeTrimMarginTop=this.trimMarginTop,this._beforeWidthAutoAdjust=this.widthAutoAdjust,this._beforeRubyOptions.rubyFontSize=this.rubyOptions.rubyFontSize,this._beforeRubyOptions.rubyFont=this.rubyOptions.rubyFont,this._beforeRubyOptions.rubyGap=this.rubyOptions.rubyGap,this._beforeRubyOptions.rubyAlign=this.rubyOptions.rubyAlign},t.prototype._updateLines=function(){for(var e=this.rubyEnabled?this.rubyParser(this.text):[this.text],t=this._divideToLines(e),i=[],n=this._beforeFontSize===this.fontSize&&this._beforeFont===this.font&&!this._isDifferentRubyOptions(this._beforeRubyOptions,this.rubyOptions),s=0;s<t.length;s++){var r=t[s],a=this._lines[s];n&&void 0!==a&&r.sourceText===a.sourceText&&r.width===a.width&&r.height===a.height?i.push(a):(a&&a.surface&&!a.surface.destroyed()&&a.surface.destroy(),this._drawLineInfoSurface(r),i.push(r))}for(s=i.length;s<this._lines.length;s++)(a=this._lines[s]).surface&&!a.surface.destroyed()&&a.surface.destroy();this._lines=i},t.prototype._drawLineInfoSurface=function(e){var t=e.fragmentDrawInfoArray,i=this._calcRubyHeightInfo(t),n=this.scene.game.resourceFactory.createSurface(Math.ceil(e.width),Math.ceil(e.height)),s=n.renderer();s.begin(),s.save();for(var a=i.hasRubyFragmentDrawInfo||this.fixLineGap?this.rubyOptions.rubyGap+i.maxRubyGlyphHeightWithOffsetY:0,o=e.minMinusOffsetY,h=0;h<t.length;h++){var u=t[h];u instanceof r.RubyFragmentDrawInfo?this._drawRubyFragmentDrawInfo(s,u,a-o,-i.minRubyMinusOffsetY):u instanceof r.StringDrawInfo&&this._drawStringGlyphs(s,this.font,u.glyphs,this.fontSize,0,a-o,0),s.translate(u.width,0)}s.restore(),s.end(),e.surface=n},t.prototype._drawStringGlyphs=function(e,t,i,n,s,r,a){void 0===a&&(a=0),e.save(),e.translate(s,r);for(var o=0;o<i.length;o++){var h=i[o],u=n/t.size,c=h.advanceWidth*u;e.save(),e.transform([u,0,0,u,0,0]),h.width>0&&h.height>0&&e.drawImage(h.surface,h.x,h.y,h.width,h.height,h.offsetX,h.offsetY),e.restore(),e.translate(c+a,0)}e.restore()},t.prototype._drawRubyFragmentDrawInfo=function(e,t,i,n){var r,a,o,h,u=t.fragment,c="rubyFontSize"in u?u.rubyFontSize:this.rubyOptions.rubyFontSize,d="rubyAlign"in u?u.rubyAlign:this.rubyOptions.rubyAlign,l="rubyFont"in u?u.rubyFont:this.rubyOptions.rubyFont,p=t.rtWidth>t.rbWidth,f=t.width,y=t.rtWidth,b=t.rbWidth;switch(d){case s.RubyAlign.Center:o=0,h=0,r=p?0:(f-y)/2,a=p?(f-b)/2:0;break;case s.RubyAlign.SpaceAround:o=t.rubyGlyphs.length>0?(f-y)/t.rubyGlyphs.length:0,h=0,r=p?0:o/2,a=p?(f-b)/2:0;break;default:throw g.ExceptionFactory.createAssertionError("Label#_drawRubyFragmentDrawInfo: unknown rubyAlign.")}this._drawStringGlyphs(e,this.font,t.glyphs,this.fontSize,a,i,h),this._drawStringGlyphs(e,l,t.rubyGlyphs,c,r,n,o)},t.prototype._calcRubyHeightInfo=function(e){for(var t,i=this.rubyOptions.rubyFontSize,n=0,s=this.rubyOptions.rubyGap,a=!1,o=0,h=0;h<e.length;h++){var u=e[h];if(u instanceof r.RubyFragmentDrawInfo){var c=u.fragment;c.rubyFontSize>i&&(i=c.rubyFontSize),c.rubyGap>s&&(s=c.rubyGap);var d=(c.rubyFontSize?c.rubyFontSize:this.rubyOptions.rubyFontSize)/(c.rubyFont?c.rubyFont.size:this.rubyOptions.rubyFont.size),l=Math.max.apply(Math,u.rubyGlyphs.map(function(e){return e.offsetY>0?e.height+e.offsetY:e.height})),p=Math.min.apply(Math,u.rubyGlyphs.map(function(e){return e.offsetY>0?e.offsetY:0}));n<l*d&&(n=l*d);var f=c.rubyFont?c.rubyFont:this.rubyOptions.rubyFont,g=this._calcStandardOffsetY(f),y=(l-Math.min(p,g))*d;o<y&&(o=y,t=Math.min(p,g)*d),a=!0}}return 0===n&&(n=this.rubyOptions.rubyFontSize),{maxRubyFontSize:i,maxRubyGlyphHeightWithOffsetY:n,minRubyMinusOffsetY:this.trimMarginTop?t:0,maxRubyGap:s,hasRubyFragmentDrawInfo:a}},t.prototype._divideToLines=function(e){for(var t={resultLines:[],currentStringDrawInfo:new r.StringDrawInfo("",0,[]),currentLineInfo:{sourceText:"",fragmentDrawInfoArray:[],width:0,height:0,minMinusOffsetY:0,surface:void 0}},i=0;i<e.length;i++){var n=e[i];if("string"==typeof n){for(var s=n.replace(/\r\n|\n/g,"\r"),a=0;a<s.length;a++)if("\r"===s[a])this._tryPushCurrentStringDrawInfo(t),this._feedLine(t);else{var o=this.font.glyphForCharacter(s[a].charCodeAt(0)),h=this.fontSize/this.font.size,u=o.advanceWidth*h;if(u<=0)continue;this._needLineBreak(t,u)&&(this._tryPushCurrentStringDrawInfo(t),this._feedLine(t)),this._addToCurrentStringDrawInfo(t,u,o,s[a])}this._tryPushCurrentStringDrawInfo(t)}else{var c=this._createRubyFragmentDrawInfo(n);if(c.width<=0)continue;this._needLineBreak(t,c.width)&&this._feedLine(t),t.currentLineInfo.fragmentDrawInfoArray.push(c),t.currentLineInfo.width+=c.width,t.currentLineInfo.sourceText+=n.text}}return this._feedLine(t),t.resultLines},t.prototype._createStringGlyph=function(e,t){return Array.prototype.map.call(e,function(e,i,n){return t.glyphForCharacter(n.charCodeAt(i))})},t.prototype._createRubyFragmentDrawInfo=function(e){var t=this._createStringGlyph(e.rb,this.font),i=this._createStringGlyph(e.rt,this.rubyOptions.rubyFont),n="rubyFont"in e?e.rubyFont:this.rubyOptions.rubyFont,s="rubyFontSize"in e?e.rubyFontSize:this.rubyOptions.rubyFontSize,a=this.fontSize/this.font.size,o=s/n.size,h=t.length>0?t.map(function(e){return e.advanceWidth}).reduce(function(e,t){return e+t})*a:0,u=i.length>0?i.map(function(e){return e.advanceWidth}).reduce(function(e,t){return e+t})*o:0,c=h>u?h:u;return new r.RubyFragmentDrawInfo(e,c,h,u,t,i)},t.prototype._tryPushCurrentStringDrawInfo=function(e){e.currentStringDrawInfo.width>0&&(e.currentLineInfo.fragmentDrawInfoArray.push(e.currentStringDrawInfo),e.currentLineInfo.width+=e.currentStringDrawInfo.width,e.currentLineInfo.sourceText+=e.currentStringDrawInfo.text),e.currentStringDrawInfo=new r.StringDrawInfo("",0,[])},t.prototype._feedLine=function(e){var t=this.fontSize/this.font.size,i=1/0,n=0,s=0;e.currentLineInfo.fragmentDrawInfoArray.forEach(function(e){e.glyphs.forEach(function(e){n>e.offsetY&&(n=e.offsetY),i>e.offsetY&&(i=e.offsetY);var t=e.offsetY>0?e.height+e.offsetY:e.height;s<t&&(s=t)})}),n*=t,s=e.currentLineInfo.fragmentDrawInfoArray.length>0?s*t-n:this.fontSize,s=Math.ceil(s);var r=this._calcRubyHeightInfo(e.currentLineInfo.fragmentDrawInfoArray);if(e.currentLineInfo.height=r.hasRubyFragmentDrawInfo||this.fixLineGap?s+r.maxRubyGlyphHeightWithOffsetY+r.maxRubyGap:s,e.currentLineInfo.minMinusOffsetY=n,this.trimMarginTop){var a=Math.min(i,this._calcStandardOffsetY(this.font))*t;e.currentLineInfo.height-=a,e.currentLineInfo.minMinusOffsetY+=a}e.resultLines.push(e.currentLineInfo),e.currentLineInfo={sourceText:"",fragmentDrawInfoArray:[],width:0,height:0,minMinusOffsetY:0,surface:void 0}},t.prototype._addToCurrentStringDrawInfo=function(e,t,i,n){e.currentStringDrawInfo.width+=t,e.currentStringDrawInfo.glyphs.push(i),e.currentStringDrawInfo.text+=n},t.prototype._needLineBreak=function(e,t){return this.lineBreak&&t>0&&e.currentLineInfo.width+e.currentStringDrawInfo.width+t>this._lineBreakWidth&&e.currentLineInfo.width+e.currentStringDrawInfo.width>0},t.prototype._isDifferentRubyOptions=function(e,t){return e.rubyFontSize!==t.rubyFontSize||e.rubyFont!==t.rubyFont||e.rubyGap!==t.rubyGap||e.rubyAlign!==t.rubyAlign},t.prototype._calcStandardOffsetY=function(e){return e.glyphForCharacter("M".charCodeAt(0)).offsetY},t}(g.CacheableE);e.exports=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.scene=e,this.group=new Map}append(e,t){let i=this.group.get(t.name);i?i.append(e):((i=new g.Pane({scene:this.scene,width:this.scene.game.width,height:this.scene.game.height,x:0,y:0,opacity:t.opacity})).append(e),this.scene.append(i),this.group.set(t.name,i))}remove(e){const t=this.group.get(e);t&&this.group.delete(e)&&(this.scene.remove(t),t.destroy())}applyConfig(e){this.evaluate(e.name,t=>{void 0!==e.visible&&(e.visible?t.show():t.hide());let i=!1;void 0!==e.opacity&&(t.opacity=e.opacity,i=!0),void 0!==e.x&&(t.x=e.x,i=!0),void 0!==e.y&&(t.y=e.y,i=!0),i&&t.modified()})}top(e){this.evaluate(e,e=>this.scene.append(e))}evaluate(e,t){const i=this.group.get(e);i?t(i):this.scene.game.logger.warn("layer not found: "+e)}}t.LayerGroup=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t){this.game=e,this.group=new Map,this.config=t}add(e,t){const i=this.config[e];i&&t.changeVolume(i);let n=this.group.get(e);n||(n=[],this.group.set(e,n)),n.push(t)}changeVolume(e,t){let i=this.group.get(e);if(i)for(const e of i)e.changeVolume(t)}remove(e){let t=this.group.get(e.groupName);if(t)if(e.assetId){const i=t.findIndex(t=>t.currentAudio.id===e.assetId);i>0?(t[i].stop(),t.splice(i,1)):this.game.logger.warn("audio not found",e)}else if(this.group.delete(e.groupName))for(const e of t)e.stop();else this.game.logger.warn("audio group not found",e)}}t.AudioGroup=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.scripts=e}register(e,t){this.scripts.set(e,t)}call(e,t){let i=this.scripts.get(t.tag);i?i(e,t.data):e.game.logger.warn("script not found: "+t.tag)}}t.ScriptManager=n},function(e,t,i){"use strict";function n(e,t){e.jump(t)}function s(e,t){e.game;const i=new o.LabelButton({scene:e,width:t.width,height:t.height,backgroundImage:t.backgroundImage,padding:t.padding,backgroundEffector:t.backgroundEffector,text:t.text,config:d.Engine.config});for(const n of t.scripts)i.click.add(()=>{d.Engine.scriptManager.call(e,n)});i.move(t.x,t.y),e.appendLayer(i,t.layer)}function r(e,t){switch(t){case 1:e.disableWindowClick();break;case 0:e.enableWindowClick()}}Object.defineProperty(t,"__esModule",{value:!0});i(1);const a=i(23),o=i(24),h=i(13),u=i(5),c=i(0),d=i(3);t.defaultSctipts=new Map([[c.Tag.image,function(e,t){e.appendLayer(h.createImage(e,t),t.layer),e.applyLayerConfig({name:t.layer.name,opacity:t.layer.opacity,visible:t.layer.visible})}],[c.Tag.pane,function(e,t){const i=new g.Pane({scene:e,width:t.width,height:t.height,x:t.layer.x,y:t.layer.y,backgroundImage:t.backgroundImage?e.assets[t.backgroundImage]:void 0,padding:t.padding,backgroundEffector:t.backgroundEffector?new g.NinePatchSurfaceEffector(e.game,t.backgroundEffector.borderWidth):void 0});i.touchable=!!t.touchable,e.appendLayer(i,t.layer)}],[c.Tag.jump,n],[c.Tag.button,function(e,t){const i=a.ImageButton.create(e,t);i.move(t.x,t.y),i.click.add(()=>{for(const i of t.scripts)d.Engine.scriptManager.call(e,i)}),e.appendLayer(i,t.layer)}],[c.Tag.choice,function(e,t){const i=e.game,n=t.values.length,s=t.width?t.width:i.width/4*3,r=t.height?t.height:32,a=t.x?t.x:s/6,h=t.y?t.y:(i.height/3*2-r*n-10*(n-1))/2;t.values.forEach((i,n)=>{let u=new o.LabelButton({scene:e,width:s,height:r,backgroundImage:t.backgroundImage,padding:t.padding,backgroundEffector:t.backgroundEffector,text:i.text,config:d.Engine.config});switch(u.click.add(()=>{d.Engine.scriptManager.call(e,i)}),t.direction?t.direction:0){case 0:u.move(a,h+(r+10)*n);break;case 1:u.move(a+(s+10)*n,h)}e.appendLayer(u,t.layer)})}],[c.Tag.link,s],[c.Tag.text,function(e,t){e.updateText(t)}],[c.Tag.layerConfig,function(e,t){e.applyLayerConfig(t)}],[c.Tag.playAudio,function(e,t){e.playAudio(t)}],[c.Tag.stopAudio,function(e,t){e.stopAudio(t)}],[c.Tag.playVideo,function(e,t){e.playVideo(t)}],[c.Tag.changeVolume,function(e,t){e.changeVolume(t)}],[c.Tag.stopVideo,function(e,t){e.stopVideo(t)}],[c.Tag.click,function(e,t){e.addSkipTrigger()}],[c.Tag.trigger,r],[c.Tag.save,function(e,t){const i=e.save(e.source.scene,t);"string"==typeof i&&e.game.logger.warn(i)}],[c.Tag.load,function(e,t){const i=e.load(t.index);i?n(e,i):e.game.logger.warn("save data not found: "+t.index)}],[c.Tag.evaluate,function(e,t){g._require(e.game,t.path)(e.gameState.variables)}],[c.Tag.condition,function(e,t){g._require(e.game,t.path)(e.gameState.variables)&&d.Engine.scriptManager.call(e,t.script)}],[c.Tag.backlog,function(e,t){const i={name:c.Layer.backlog};for(const i of t.scripts)d.Engine.scriptManager.call(e,i);r(e,1);const n=new u.Message({scene:e,config:d.Engine.config,width:e.game.width-20,x:20,y:20,gameState:e.gameState});let a=[];for(const t of e.backlog)for(const e of t.scripts.filter(e=>e.tag===c.Tag.text).map(e=>e.data.values))a=a.concat("\n",e);n.updateText({values:a}),n.showAll(),e.appendLayer(n,i);const o=[{tag:c.Tag.removeLayer,data:{name:i.name}}];s(e,{layer:i,x:e.game.width-100-10,y:20,width:100,height:24,text:"close",scripts:o})}],[c.Tag.removeLayer,function(e,t){e.removeLayer(t.name)}]])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(12),s=i(13);class r extends n.Button{constructor(e,t){super({scene:e,width:t.width,height:t.height}),this.append(t)}static create(e,t){return new r(e,s.createImage(e,t))}}t.ImageButton=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(12);class s extends n.Button{constructor(e){super(e);let t=new g.Label({scene:this.scene,text:e.text,font:new g.DynamicFont({game:this.scene.game,fontFamily:g.FontFamily.SansSerif,size:18}),fontSize:18,textColor:e.config.font.color});t.aligning(this.width,g.TextAlign.Center),t.invalidate(),this.append(t)}}t.LabelButton=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.index=0,this._label=e.label,this.frames=e.frames}get label(){return this._label}get frame(){return this.index<this.frames.length?this.frames[this.index]:void 0}get assetIds(){let e=[];return this.frames.forEach(t=>{e=e.concat(t.assetIds)}),e}next(){return this.index<this.frames.length?(this.index++,this.frames[this.index]):void 0}reset(e){this.index=e||0}createSaveData(e){return{label:this._label,frame:this.index,variables:e}}}t.Scene=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(1);class s{constructor(e){this._scripts=e}get scripts(){return this._scripts}get assetIds(){return n.collectAssetIds(this._scripts)}}t.Frame=s},function(e,t,i){var n=i(28),s=i(32),r=function(){function e(e,t){this._target=e,this._stepIndex=0,this._loop=!!t&&!!t.loop,this._modifiedHandler=t&&t.modified?t.modified:void 0,this._destroyedHandler=t&&t.destroyed?t.destroyed:void 0,this._steps=[],this._lastStep=void 0,this._pararel=!1,this.paused=!1}return e.prototype.to=function(e,t,i){void 0===i&&(i=n.linear);var r={input:e,duration:t,easing:i,type:s.TweenTo,initialized:!1};return this._push(r),this},e.prototype.by=function(e,t,i,r){void 0===i&&(i=n.linear),void 0===r&&(r=!1);var a={input:e,duration:t,easing:i,type:r?s.TweenByMult:s.TweenBy,initialized:!1};return this._push(a),this},e.prototype.con=function(){return this._pararel=!0,this},e.prototype.wait=function(e){var t={duration:e,type:s.Wait,initialized:!1};return this._push(t),this},e.prototype.call=function(e){var t={func:e,type:s.Call,duration:0,initialized:!1};return this._push(t),this},e.prototype.pause=function(){var e=this;return this.call(function(){e.paused=!0})},e.prototype.cue=function(e){var t=Object.keys(e);t.sort(function(e,t){return Number(e)>Number(t)?1:-1});for(var i=[],n=0;n<t.length;++n)i.push({time:Number(t[n]),func:e[t[n]]});var r={type:s.Cue,duration:Number(t[t.length-1]),cue:i,initialized:!1};return this._push(r),this},e.prototype.every=function(e,t,i){void 0===i&&(i=n.linear);var r={func:e,type:s.Every,easing:i,duration:t,initialized:!1};return this._push(r),this},e.prototype.fadeIn=function(e,t){return void 0===t&&(t=n.linear),this.to({opacity:1},e,t)},e.prototype.fadeOut=function(e,t){return void 0===t&&(t=n.linear),this.to({opacity:0},e,t)},e.prototype.moveTo=function(e,t,i,s){return void 0===s&&(s=n.linear),this.to({x:e,y:t},i,s)},e.prototype.moveBy=function(e,t,i,s){return void 0===s&&(s=n.linear),this.by({x:e,y:t},i,s)},e.prototype.moveX=function(e,t,i){return void 0===i&&(i=n.linear),this.to({x:e},t,i)},e.prototype.moveY=function(e,t,i){return void 0===i&&(i=n.linear),this.to({y:e},t,i)},e.prototype.rotateTo=function(e,t,i){return void 0===i&&(i=n.linear),this.to({angle:e},t,i)},e.prototype.rotateBy=function(e,t,i){return void 0===i&&(i=n.linear),this.by({angle:e},t,i)},e.prototype.scaleTo=function(e,t,i,s){return void 0===s&&(s=n.linear),this.to({scaleX:e,scaleY:t},i,s)},e.prototype.scaleBy=function(e,t,i,s){return void 0===s&&(s=n.linear),this.by({scaleX:e,scaleY:t},i,s,!0)},e.prototype.destroyed=function(){var e=!1;return this._destroyedHandler&&(e=this._destroyedHandler.call(this._target)),e||(e=this._stepIndex>=this._steps.length&&!this._loop),e},e.prototype._fire=function(e){if(0!==this._steps.length&&!this.destroyed()&&!this.paused){if(this._stepIndex>=this._steps.length){if(!this._loop)return;this._stepIndex=0}for(var t=this._steps[this._stepIndex],i=!1,n=0;n<t.length;++n){var r=t[n];if(r.initialized||this._initAction(r),!r.finished){switch(r.elapsed+=e,r.type){case s.Call:r.func.call(this._target);break;case s.Every:var a=r.easing(r.elapsed,0,1,r.duration);a>1&&(a=1),r.func.call(this._target,r.elapsed,a);break;case s.TweenTo:case s.TweenBy:case s.TweenByMult:for(var o=Object.keys(r.goal),h=0;h<o.length;++h){var u=o[h];r.elapsed>=r.duration?this._target[u]=r.goal[u]:this._target[u]=r.easing(r.elapsed,r.start[u],r.goal[u]-r.start[u],r.duration)}break;case s.Cue:var c=r.cue[r.cueIndex];void 0!==c&&r.elapsed>=c.time&&(c.func.call(this._target),++r.cueIndex)}this._modifiedHandler&&this._modifiedHandler.call(this._target),r.elapsed>=r.duration?r.finished=!0:i=!0}}if(!i){for(var d=0;d<t.length;++d)t[d].initialized=!1;++this._stepIndex}}},e.prototype.serializeState=function(){for(var e={_stepIndex:this._stepIndex,_steps:[]},t=0;t<this._steps.length;++t){e._steps[t]=[];for(var i=0;i<this._steps[t].length;++i)e._steps[t][i]={input:this._steps[t][i].input,start:this._steps[t][i].start,goal:this._steps[t][i].goal,duration:this._steps[t][i].duration,elapsed:this._steps[t][i].elapsed,type:this._steps[t][i].type,cueIndex:this._steps[t][i].cueIndex,initialized:this._steps[t][i].initialized,finished:this._steps[t][i].finished}}return e},e.prototype.deserializeState=function(e){this._stepIndex=e._stepIndex;for(var t=0;t<e._steps.length;++t)for(var i=0;i<e._steps[t].length;++i)e._steps[t][i]&&this._steps[t][i]&&(this._steps[t][i].input=e._steps[t][i].input,this._steps[t][i].start=e._steps[t][i].start,this._steps[t][i].goal=e._steps[t][i].goal,this._steps[t][i].duration=e._steps[t][i].duration,this._steps[t][i].elapsed=e._steps[t][i].elapsed,this._steps[t][i].type=e._steps[t][i].type,this._steps[t][i].cueIndex=e._steps[t][i].cueIndex,this._steps[t][i].initialized=e._steps[t][i].initialized,this._steps[t][i].finished=e._steps[t][i].finished)},e.prototype._push=function(e){if(this._pararel)this._lastStep.push(e);else{var t=this._steps.push([e])-1;this._lastStep=this._steps[t]}this._pararel=!1},e.prototype._initAction=function(e){if(e.elapsed=0,e.start={},e.goal={},e.cueIndex=0,e.finished=!1,e.initialized=!0,e.type===s.TweenTo||e.type===s.TweenBy||e.type===s.TweenByMult)for(var t=Object.keys(e.input),i=0;i<t.length;++i){var n=t[i];void 0!==this._target[n]&&(e.start[n]=this._target[n],e.type===s.TweenTo?e.goal[n]=e.input[n]:e.type===s.TweenBy?e.goal[n]=e.start[n]+e.input[n]:e.type===s.TweenByMult&&(e.goal[n]=e.start[n]*e.input[n]))}},e}();e.exports=r},function(e,t){var i;!function(e){e.linear=function(e,t,i,n){return i*e/n+t},e.easeInQuad=function(e,t,i,n){return e/=n,i*e*e+t},e.easeOutQuad=function(e,t,i,n){return e/=n,-i*e*(e-2)+t},e.easeInOutQuad=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:(--e,-i/2*(e*(e-2)-1)+t)},e.easeInQubic=function(e,t,i,n){return e/=n,i*e*e*e+t},e.easeOutQubic=function(e,t,i,n){return e/=n,--e,i*(e*e*e+1)+t},e.easeInOutQubic=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:(e-=2,i/2*(e*e*e+2)+t)},e.easeInQuart=function(e,t,i,n){return e/=n,i*e*e*e*e+t},e.easeOutQuart=function(e,t,i,n){return e/=n,--e,-i*(e*e*e*e-1)+t},e.easeInQuint=function(e,t,i,n){return e/=n,i*e*e*e*e*e+t},e.easeOutQuint=function(e,t,i,n){return e/=n,--e,i*(e*e*e*e*e+1)+t},e.easeInOutQuint=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:(e-=2,i/2*(e*e*e*e*e+2)+t)},e.easeInSine=function(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t},e.easeOutSine=function(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t},e.easeInOutSine=function(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t},e.easeInExpo=function(e,t,i,n){return i*Math.pow(2,10*(e/n-1))+t},e.easeInOutExpo=function(e,t,i,n){return(e/=n/2)<1?i/2*Math.pow(2,10*(e-1))+t:(--e,i/2*(2-Math.pow(2,-10*e))+t)},e.easeInCirc=function(e,t,i,n){return e/=n,-i*(Math.sqrt(1-e*e)-1)+t},e.easeOutCirc=function(e,t,i,n){return e/=n,--e,i*Math.sqrt(1-e*e)+t},e.easeInOutCirc=function(e,t,i,n){return(e/=n/2)<1?-i/2*(Math.sqrt(1-e*e)-1)+t:(e-=2,i/2*(Math.sqrt(1-e*e)+1)+t)}}(i||(i={})),e.exports=i},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(30),s=i(2);e.exports=function(){s.engine.script("noop",(e,t)=>{}),s.engine.script("logo",(e,t)=>{e.transition(t.layer,i=>{new n.Timeline(e).create(i,{modified:i.invalidate,destroyed:i.destroyed}).fadeIn(t.duration).wait(t.wait).fadeOut(t.duration).call(()=>e.requestNextFrame())})}),s.engine.start()}},function(e,t,i){t.Timeline=i(31),t.Tween=i(27),t.Easing=i(28)},function(e,t,i){var n=i(27),s=function(){function e(e){this._scene=e,this._tweens=[],this._fps=this._scene.game.fps,this.paused=!1,e.update.handle(this,this._handler)}return e.prototype.create=function(e,t){var i=new n(e,t);return this._tweens.push(i),i},e.prototype.remove=function(e){var t=this._tweens.indexOf(e);t<0||this._tweens.splice(t,1)},e.prototype.clear=function(){this._tweens.length=0},e.prototype.destroy=function(){this._tweens.length=0,this._scene.destroyed()||this._scene.update.remove(this,this._handler),this._scene=void 0},e.prototype.destroyed=function(){return void 0===this._scene},e.prototype._handler=function(){if(0!==this._tweens.length&&!this.paused){for(var e=[],t=0;t<this._tweens.length;++t){var i=this._tweens[t];i.destroyed()||(i._fire(1e3/this._fps),e.push(i))}this._tweens=e}},e}();e.exports=s},function(e,t){var i;!function(e){e[e.Wait=0]="Wait",e[e.Call=1]="Call",e[e.TweenTo=2]="TweenTo",e[e.TweenBy=3]="TweenBy",e[e.TweenByMult=4]="TweenByMult",e[e.Cue=5]="Cue",e[e.Every=6]="Every"}(i||(i={})),e.exports=i}]);